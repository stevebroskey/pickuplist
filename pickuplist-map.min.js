(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Array.prototype.slice;window.pickuplist==null&&(window.pickuplist={}),pickuplist.Map=function(){function c(a){var b;b=document.createElement("script"),b.type="text/javascript",b.src="http://maps.google.com/maps/api/js?sensor=false&callback="+a,document.body.appendChild(b)}c.prototype.showMap=function(b,c,d,e){this.datasource=c,this.geocoder=new google.maps.Geocoder,this.map=new google.maps.Map(document.getElementById(b),{zoom:e!=null?e:4,center:d!=null?d:new google.maps.LatLng(37.997,-95.801),mapTypeId:google.maps.MapTypeId.ROADMAP,backgroundColor:"#99b3cc"}),this.fusion=new google.maps.FusionTablesLayer({suppressInfoWindows:!0,map:this.map,query:{select:"latitude",from:this.datasource},styles:[{markerOptions:{iconName:"large_red"}}]}),google.maps.event.addListener(this.fusion,"click",a(function(a){var b;if(this.showData!=null)return b=new google.maps.LatLng(a.row.latitude.value,a.row.longitude.value),this.showInfo(this.showData(a.row.id.value,a.row.data.value,b),b,a.pixelOffset)},this));return google.maps.event.addListener(this.map,"rightclick",a(function(a){if(this.newData!=null)return this.showInfo(this.newData(a.latLng),a.latLng,new google.maps.Size(0,0))},this))},c.prototype.showData_callback=function(a){this.showData=a},c.prototype.newData_callback=function(a){this.newData=a},c.prototype.hideData_callback=function(a){this.hideData=a},c.prototype.idle_callback=function(a){this.idleAction=a},c.prototype.showInfo=function(b,c,d){var e,g,h,i;d==null&&(d=new google.maps.Size(0,-32,"px","px")),this.infowindows==null&&(this.infowindows=[]),i=this.infowindows,g=0;for(h=i.length;g<h;g++)e=i[g],e.close();this.infowindows.length=0,b=new google.maps.InfoWindow({content:b,position:c,pixelOffset:d}),google.maps.event.addListener(b,"closeclick",a(function(){return typeof this.hideData=="function"?this.hideData():void 0},this)),b.open(this.map);return this.infowindows.push(b)},c.prototype.setCenter=function(a,b){typeof a=="object"?a.coords!=null?this.map.setCenter(new google.maps.LatLng(a.coords.latitude,a.coords.longitude)):this.map.setCenter(new google.maps.LatLng(a[0],a[1])):this.map.setCenter(a);if(b!=null)return this.setZoom(b)},c.prototype.setZoom=function(a){return this.map.setZoom(a)},c.prototype.setLocation=function(b){if(typeof b=="object")return this.setCenter(b);if(b.trim()!=="")return this.geocode(b,a(function(a){return this.map.fitBounds(a[0].geometry.viewport)},this))},c.prototype.filter=function(a){var b,c,d,e;e=function(){var c,d,e,f;e=a.trim().split(/\s+/),f=[],c=0;for(d=e.length;c<d;c++)b=e[c],f.push(b.replace("'","\\'"));return f}(),c={query:{select:"latitude",from:this.datasource,where:null},styles:[{markerOptions:{iconName:"large_red"}}]},e[0].length!==0&&(c.query.where=function(){var a,b,c;c=[],a=0;for(b=e.length;a<b;a++)d=e[a],c.push("data CONTAINS IGNORING CASE '"+d+"'");return c}().join(" AND "),c.styles[0].markerOptions.iconName="large_yellow");return this.fusion.setOptions(c)},c.prototype.geocode=function(){var a,c;c=1<=arguments.length?b.call(arguments,0):[],a={},c.length===2?typeof c[0]=="string"?a={address:c[0]}:typeof c[0]=="object"&&(a={latLng:c[0]}):c.length===3&&(a={latLng:new google.maps.LatLng(c[0],c[1])});return this.geocoder.geocode(a,function(a,b){if(b===google.maps.GeocoderStatus.OK)return c[c.length-1](a)})};return c}()}).call(this)